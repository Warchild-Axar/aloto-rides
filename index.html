<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aloto Rides - Business Management</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Aloto Rides">
    <link rel="apple-touch-icon" href="icon-svg.svg">
    <link rel="icon" type="image/svg+xml" href="icon-svg.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        .chat-bubble {
            max-width: 70%;
            word-wrap: break-word;
        }
        .map-container {
            height: 400px;
            border-radius: 8px;
            overflow: hidden;
        }
        .rider-marker {
            background-color: #3b82f6;
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen">
        <!-- Header -->
        <header class="bg-blue-600 text-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                        </svg>
                        <h1 class="text-2xl font-bold">Aloto Rides</h1>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="text-sm">Admin Dashboard</span>
                        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                            <span class="text-xs">AD</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <div class="bg-white border-b shadow-sm">
            <div class="container mx-auto px-4">
                <nav class="flex space-x-1">
                    <button onclick="switchTab('orders')" id="tab-orders" class="tab-btn px-6 py-3 font-medium border-b-2 border-blue-600 text-blue-600">
                        Orders
                    </button>
                    <button onclick="switchTab('riders')" id="tab-riders" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900">
                        Rider Tracking
                    </button>
                    <button onclick="switchTab('navigation')" id="tab-navigation" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900">
                        Navigation
                    </button>
                    <button onclick="switchTab('chat')" id="tab-chat" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900">
                        Customer Chat
                        <span id="chat-badge" class="ml-2 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full">3</span>
                    </button>
                    <button onclick="switchTab('settings')" id="tab-settings" class="tab-btn px-6 py-3 font-medium border-b-2 border-transparent text-gray-600 hover:text-gray-900">
                        <svg class="w-4 h-4 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        Settings
                    </button>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <main class="container mx-auto px-4 py-6">
            
            <!-- Orders Section -->
            <div id="section-orders" class="section-content">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                    <!-- Stats Cards -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Active Orders</p>
                                <p class="text-3xl font-bold text-blue-600" id="active-orders-count">12</p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                                <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Available Riders</p>
                                <p class="text-3xl font-bold text-green-600" id="available-riders-count">8</p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-500 text-sm">Today's Revenue</p>
                                <p class="text-3xl font-bold text-purple-600">$1,248</p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- New Order Form -->
                <div class="bg-white p-6 rounded-lg shadow mb-6">
                    <h2 class="text-xl font-bold mb-4">Create New Order</h2>
                    <form id="new-order-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Customer Name</label>
                            <input type="text" id="customer-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="John Doe">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Customer Phone</label>
                            <input type="tel" id="customer-phone" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="+1 234 567 8900">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pickup Address</label>
                            <input type="text" id="pickup-address" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="123 Main St">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Delivery Address</label>
                            <input type="text" id="delivery-address" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="456 Oak Ave">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Package Type</label>
                            <select id="package-type" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option>Document</option>
                                <option>Small Package</option>
                                <option>Medium Package</option>
                                <option>Large Package</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Delivery Fee</label>
                            <input type="number" id="delivery-fee" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="15.00" step="0.01">
                        </div>
                        <div class="md:col-span-2">
                            <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition">
                                Create Order
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Orders List -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-xl font-bold mb-4">Active Orders</h2>
                    <div id="orders-list" class="space-y-4">
                        <!-- Orders will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Rider Tracking Section -->
            <div id="section-riders" class="section-content hidden">
                <div class="bg-white p-6 rounded-lg shadow mb-6">
                    <h2 class="text-xl font-bold mb-4">Live Rider Tracking</h2>
                    <div id="riders-map" class="map-container"></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div id="riders-list">
                        <!-- Rider cards will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Navigation Section -->
            <div id="section-navigation" class="section-content hidden">
                <div class="bg-white p-6 rounded-lg shadow mb-6">
                    <h2 class="text-xl font-bold mb-4">Route Navigation</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <input type="text" id="nav-start" placeholder="Start address" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <input type="text" id="nav-end" placeholder="Destination address" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <button onclick="calculateRoute()" class="bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 transition">
                            Calculate Route
                        </button>
                    </div>
                    <div id="navigation-map" class="map-container"></div>
                    <div id="route-info" class="mt-4 p-4 bg-blue-50 rounded-lg hidden">
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <p class="text-sm text-gray-600">Estimated Distance</p>
                                <p class="text-lg font-bold" id="route-distance">-</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Estimated Time</p>
                                <p class="text-lg font-bold" id="route-duration">-</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Section -->
            <div id="section-chat" class="section-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Chat List -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="p-4 border-b">
                            <h2 class="text-xl font-bold">Customer Chats</h2>
                        </div>
                        <div id="chat-list" class="divide-y max-h-[600px] overflow-y-auto">
                            <!-- Chat items will be inserted here -->
                        </div>
                    </div>

                    <!-- Active Chat -->
                    <div class="lg:col-span-2 bg-white rounded-lg shadow flex flex-col" style="height: 650px;">
                        <div class="p-4 border-b flex items-center justify-between">
                            <div id="active-chat-header" class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center">
                                    <span class="text-sm font-bold">?</span>
                                </div>
                                <div>
                                    <p class="font-bold">Select a chat</p>
                                    <p class="text-xs text-gray-500">No active conversation</p>
                                </div>
                            </div>
                        </div>
                        <div id="chat-messages" class="flex-1 p-4 overflow-y-auto bg-gray-50">
                            <div class="text-center text-gray-500 mt-20">
                                Select a customer to start chatting
                            </div>
                        </div>
                        <div class="p-4 border-t">
                            <form id="chat-form" class="flex space-x-2">
                                <input type="text" id="chat-input" placeholder="Type a message..." class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition">
                                    Send
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="section-settings" class="section-content hidden">
                <div class="max-w-4xl mx-auto">
                    
                    <!-- App Branding -->
                    <div class="bg-white p-6 rounded-lg shadow mb-6">
                        <h2 class="text-2xl font-bold mb-4 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                            App Branding & Logo
                        </h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Current Logo Preview -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Current App Logo</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center bg-gray-50">
                                    <img id="logo-preview" src="" alt="App Logo" class="mx-auto h-32 w-32 object-contain hidden">
                                    <div id="logo-placeholder" class="mx-auto h-32 w-32 bg-blue-600 rounded-lg flex items-center justify-center">
                                        <svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                                        </svg>
                                    </div>
                                    <p class="text-sm text-gray-500 mt-2">Aloto Rides</p>
                                </div>
                            </div>

                            <!-- Upload New Logo -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Upload New Logo</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6">
                                    <input type="file" id="logo-upload" accept="image/*" class="hidden">
                                    <button onclick="document.getElementById('logo-upload').click()" class="w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 mb-3">
                                        Choose Logo Image
                                    </button>
                                    <p class="text-xs text-gray-500 text-center">PNG, JPG, or SVG (recommended: 512x512px)</p>
                                    <button onclick="updateLogo()" class="w-full bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700 mt-3">
                                        Apply Logo
                                    </button>
                                    <button onclick="resetLogo()" class="w-full bg-gray-600 text-white py-2 rounded-lg font-medium hover:bg-gray-700 mt-2">
                                        Reset to Default
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Company Images Gallery -->
                    <div class="bg-white p-6 rounded-lg shadow mb-6">
                        <h2 class="text-2xl font-bold mb-4 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                            Company Images Gallery
                        </h2>
                        <p class="text-gray-600 mb-4">Upload and manage images for riders, vehicles, and promotional materials</p>

                        <!-- Upload Section -->
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 mb-6 bg-gray-50">
                            <input type="file" id="gallery-upload" accept="image/*" multiple class="hidden">
                            <div class="text-center">
                                <svg class="w-12 h-12 mx-auto text-gray-400 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                </svg>
                                <button onclick="document.getElementById('gallery-upload').click()" class="bg-blue-600 text-white py-2 px-6 rounded-lg font-medium hover:bg-blue-700">
                                    Upload Images
                                </button>
                                <p class="text-sm text-gray-500 mt-2">Click to upload or drag and drop</p>
                                <p class="text-xs text-gray-400">PNG, JPG, GIF up to 10MB each</p>
                            </div>
                        </div>

                        <!-- Image Gallery Grid -->
                        <div id="image-gallery" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- Images will be inserted here -->
                        </div>
                    </div>

                    <!-- App Customization -->
                    <div class="bg-white p-6 rounded-lg shadow mb-6">
                        <h2 class="text-2xl font-bold mb-4 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                            </svg>
                            App Customization
                        </h2>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Company Name</label>
                                <input type="text" id="company-name" value="Aloto Rides" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Primary Color</label>
                                <div class="flex items-center space-x-3">
                                    <input type="color" id="primary-color" value="#2563eb" class="h-10 w-20 border border-gray-300 rounded cursor-pointer">
                                    <span class="text-sm text-gray-600">Choose your brand color</span>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Contact Email</label>
                                <input type="email" id="contact-email" placeholder="support@alotorides.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Contact Phone</label>
                                <input type="tel" id="contact-phone" placeholder="+1 234 567 8900" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>

                            <button onclick="saveSettings()" class="w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700">
                                Save All Settings
                            </button>
                        </div>
                    </div>

                    <!-- Export/Import Settings -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-2xl font-bold mb-4 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/>
                            </svg>
                            Backup & Restore
                        </h2>
                        <p class="text-gray-600 mb-4">Export your settings and images to backup or transfer to another device</p>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <button onclick="exportSettings()" class="bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                                </svg>
                                Export Settings
                            </button>
                            <button onclick="document.getElementById('import-settings').click()" class="bg-gray-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-gray-700 flex items-center justify-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/>
                                </svg>
                                Import Settings
                            </button>
                            <input type="file" id="import-settings" accept=".json" class="hidden">
                        </div>
                    </div>

                </div>
            </div>
        </main>
    </div>

    <script>
        // Application State
        const state = {
            orders: [],
            riders: [],
            chats: [],
            activeChat: null,
            maps: {}
        };

        // Initialize sample data
        function initializeSampleData() {
            // Sample riders
            state.riders = [
                { id: 1, name: 'Mike Johnson', status: 'active', lat: 40.7589, lng: -73.9851, orderId: 'ORD-001' },
                { id: 2, name: 'Sarah Smith', status: 'active', lat: 40.7489, lng: -73.9680, orderId: 'ORD-002' },
                { id: 3, name: 'David Lee', status: 'available', lat: 40.7389, lng: -73.9850, orderId: null },
                { id: 4, name: 'Emma Wilson', status: 'active', lat: 40.7289, lng: -73.9950, orderId: 'ORD-003' },
                { id: 5, name: 'James Brown', status: 'available', lat: 40.7189, lng: -73.9750, orderId: null },
            ];

            // Sample orders
            state.orders = [
                { 
                    id: 'ORD-001', 
                    customer: 'Alice Cooper', 
                    phone: '+1 234 567 8901',
                    pickup: '789 Broadway, NY', 
                    delivery: '321 5th Ave, NY',
                    packageType: 'Document',
                    fee: 12.00,
                    status: 'in-transit', 
                    riderId: 1,
                    time: '10:30 AM' 
                },
                { 
                    id: 'ORD-002', 
                    customer: 'Bob Martin', 
                    phone: '+1 234 567 8902',
                    pickup: '456 Park Ave, NY', 
                    delivery: '789 Madison Ave, NY',
                    packageType: 'Small Package',
                    fee: 15.00,
                    status: 'in-transit', 
                    riderId: 2,
                    time: '11:15 AM' 
                },
                { 
                    id: 'ORD-003', 
                    customer: 'Carol White', 
                    phone: '+1 234 567 8903',
                    pickup: '123 Wall St, NY', 
                    delivery: '456 Broadway, NY',
                    packageType: 'Medium Package',
                    fee: 20.00,
                    status: 'picked-up', 
                    riderId: 4,
                    time: '11:45 AM' 
                },
            ];

            // Sample chats
            state.chats = [
                {
                    id: 1,
                    customerId: 'CUST-001',
                    customerName: 'Alice Cooper',
                    orderId: 'ORD-001',
                    unread: 2,
                    lastMessage: 'How long until delivery?',
                    timestamp: '2 min ago',
                    messages: [
                        { sender: 'customer', text: 'Hi, I placed an order', time: '10:30 AM' },
                        { sender: 'admin', text: 'Hello! Yes, your order has been assigned to Mike Johnson', time: '10:32 AM' },
                        { sender: 'customer', text: 'How long until delivery?', time: '10:45 AM' },
                    ]
                },
                {
                    id: 2,
                    customerId: 'CUST-002',
                    customerName: 'Bob Martin',
                    orderId: 'ORD-002',
                    unread: 1,
                    lastMessage: 'Can you add special instructions?',
                    timestamp: '5 min ago',
                    messages: [
                        { sender: 'customer', text: 'Can you add special instructions?', time: '11:10 AM' },
                    ]
                },
                {
                    id: 3,
                    customerId: 'CUST-003',
                    customerName: 'Carol White',
                    orderId: 'ORD-003',
                    unread: 0,
                    lastMessage: 'Thank you!',
                    timestamp: '15 min ago',
                    messages: [
                        { sender: 'customer', text: 'Is my package on the way?', time: '11:30 AM' },
                        { sender: 'admin', text: 'Yes, Emma is on her way with your package', time: '11:32 AM' },
                        { sender: 'customer', text: 'Thank you!', time: '11:33 AM' },
                    ]
                },
            ];

            renderOrders();
            renderRiders();
            renderChatList();
            updateStats();
        }

        // Tab Switching
        function switchTab(tab) {
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-blue-600', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-600');
            });
            
            document.getElementById(`section-${tab}`).classList.remove('hidden');
            document.getElementById(`tab-${tab}`).classList.add('border-blue-600', 'text-blue-600');
            document.getElementById(`tab-${tab}`).classList.remove('border-transparent', 'text-gray-600');

            if (tab === 'riders') {
                setTimeout(initializeRidersMap, 100);
            } else if (tab === 'navigation') {
                setTimeout(initializeNavigationMap, 100);
            }
        }

        // Orders Management
        function renderOrders() {
            const ordersList = document.getElementById('orders-list');
            ordersList.innerHTML = state.orders.map(order => {
                const rider = state.riders.find(r => r.id === order.riderId);
                const statusColors = {
                    'pending': 'bg-yellow-100 text-yellow-800',
                    'picked-up': 'bg-blue-100 text-blue-800',
                    'in-transit': 'bg-purple-100 text-purple-800',
                    'delivered': 'bg-green-100 text-green-800',
                };
                return `
                    <div class="border rounded-lg p-4 hover:shadow-md transition">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-2">
                                    <h3 class="font-bold text-lg">${order.id}</h3>
                                    <span class="status-badge ${statusColors[order.status]}">${order.status.replace('-', ' ').toUpperCase()}</span>
                                </div>
                                <p class="text-gray-600"><strong>Customer:</strong> ${order.customer} (${order.phone})</p>
                                <p class="text-gray-600 text-sm mt-1"><strong>Pickup:</strong> ${order.pickup}</p>
                                <p class="text-gray-600 text-sm"><strong>Delivery:</strong> ${order.delivery}</p>
                                <p class="text-gray-600 text-sm"><strong>Package:</strong> ${order.packageType} | <strong>Fee:</strong> $${order.fee.toFixed(2)}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm text-gray-500">${order.time}</p>
                                ${rider ? `<p class="text-sm font-medium text-blue-600 mt-1">Rider: ${rider.name}</p>` : '<p class="text-sm text-gray-400 mt-1">No rider assigned</p>'}
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            ${!rider ? `<button onclick="assignRider('${order.id}')" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 text-sm">Assign Rider</button>` : ''}
                            <button onclick="trackOrder('${order.id}')" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded hover:bg-gray-700 text-sm">Track</button>
                            <button onclick="openChat('${order.customer}')" class="flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 text-sm">Chat</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // New Order Form
        document.getElementById('new-order-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const newOrder = {
                id: 'ORD-' + String(state.orders.length + 1).padStart(3, '0'),
                customer: document.getElementById('customer-name').value,
                phone: document.getElementById('customer-phone').value,
                pickup: document.getElementById('pickup-address').value,
                delivery: document.getElementById('delivery-address').value,
                packageType: document.getElementById('package-type').value,
                fee: parseFloat(document.getElementById('delivery-fee').value),
                status: 'pending',
                riderId: null,
                time: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })
            };
            
            state.orders.unshift(newOrder);
            renderOrders();
            updateStats();
            this.reset();
            alert('Order created successfully!');
        });

        // Rider Tracking
        function renderRiders() {
            const ridersList = document.getElementById('riders-list');
            ridersList.innerHTML = state.riders.map(rider => {
                const statusColors = {
                    'active': 'bg-green-100 text-green-800',
                    'available': 'bg-blue-100 text-blue-800',
                    'offline': 'bg-gray-100 text-gray-800',
                };
                const order = state.orders.find(o => o.id === rider.orderId);
                return `
                    <div class="bg-white p-4 rounded-lg shadow border">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center space-x-3">
                                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
                                    ${rider.name.split(' ').map(n => n[0]).join('')}
                                </div>
                                <div>
                                    <h3 class="font-bold">${rider.name}</h3>
                                    <span class="status-badge ${statusColors[rider.status]}">${rider.status.toUpperCase()}</span>
                                </div>
                            </div>
                        </div>
                        ${order ? `
                            <div class="bg-gray-50 p-3 rounded mt-2">
                                <p class="text-sm font-medium text-gray-700">Current Order: ${order.id}</p>
                                <p class="text-xs text-gray-600 mt-1">${order.delivery}</p>
                            </div>
                        ` : '<p class="text-sm text-gray-500 mt-2">No active delivery</p>'}
                        <button onclick="focusRider(${rider.id})" class="w-full mt-3 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 text-sm">
                            View on Map
                        </button>
                    </div>
                `;
            }).join('');
        }

        function initializeRidersMap() {
            if (state.maps.riders) {
                state.maps.riders.remove();
            }
            
            const map = L.map('riders-map').setView([40.7489, -73.9680], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            state.riders.forEach(rider => {
                const marker = L.marker([rider.lat, rider.lng]).addTo(map);
                marker.bindPopup(`
                    <strong>${rider.name}</strong><br>
                    Status: ${rider.status}<br>
                    ${rider.orderId ? `Order: ${rider.orderId}` : 'Available'}
                `);
            });

            state.maps.riders = map;
            
            // Simulate real-time updates
            setInterval(() => {
                state.riders.forEach(rider => {
                    if (rider.status === 'active') {
                        rider.lat += (Math.random() - 0.5) * 0.001;
                        rider.lng += (Math.random() - 0.5) * 0.001;
                    }
                });
            }, 5000);
        }

        function focusRider(riderId) {
            const rider = state.riders.find(r => r.id === riderId);
            if (rider && state.maps.riders) {
                state.maps.riders.setView([rider.lat, rider.lng], 15);
            }
        }

        // Navigation
        function initializeNavigationMap() {
            if (state.maps.navigation) {
                state.maps.navigation.remove();
            }
            
            const map = L.map('navigation-map').setView([40.7589, -73.9851], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);

            state.maps.navigation = map;
        }

        function calculateRoute() {
            const start = document.getElementById('nav-start').value;
            const end = document.getElementById('nav-end').value;
            
            if (!start || !end) {
                alert('Please enter both start and destination addresses');
                return;
            }

            // Simulate route calculation
            const distance = (Math.random() * 10 + 2).toFixed(1);
            const duration = (Math.random() * 30 + 10).toFixed(0);
            
            document.getElementById('route-distance').textContent = distance + ' km';
            document.getElementById('route-duration').textContent = duration + ' min';
            document.getElementById('route-info').classList.remove('hidden');

            // Draw a simple route line (simulated)
            if (state.maps.navigation) {
                const startCoords = [40.7589, -73.9851];
                const endCoords = [40.7489 + Math.random() * 0.02, -73.9680 + Math.random() * 0.02];
                
                L.marker(startCoords).addTo(state.maps.navigation)
                    .bindPopup('Start: ' + start);
                L.marker(endCoords).addTo(state.maps.navigation)
                    .bindPopup('Destination: ' + end);
                L.polyline([startCoords, endCoords], {color: 'blue', weight: 4}).addTo(state.maps.navigation);
                
                state.maps.navigation.fitBounds([startCoords, endCoords]);
            }
        }

        // Chat System
        function renderChatList() {
            const chatList = document.getElementById('chat-list');
            chatList.innerHTML = state.chats.map(chat => `
                <div onclick="openChatById(${chat.id})" class="p-4 hover:bg-gray-50 cursor-pointer ${state.activeChat === chat.id ? 'bg-blue-50' : ''}">
                    <div class="flex items-start justify-between">
                        <div class="flex items-start space-x-3 flex-1">
                            <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold flex-shrink-0">
                                ${chat.customerName.split(' ').map(n => n[0]).join('')}
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center justify-between">
                                    <h4 class="font-bold text-sm">${chat.customerName}</h4>
                                    ${chat.unread > 0 ? `<span class="bg-red-500 text-white text-xs px-2 py-0.5 rounded-full">${chat.unread}</span>` : ''}
                                </div>
                                <p class="text-xs text-gray-500">Order: ${chat.orderId}</p>
                                <p class="text-sm text-gray-600 truncate">${chat.lastMessage}</p>
                                <p class="text-xs text-gray-400 mt-1">${chat.timestamp}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openChatById(chatId) {
            const chat = state.chats.find(c => c.id === chatId);
            if (!chat) return;

            state.activeChat = chatId;
            chat.unread = 0;
            renderChatList();
            updateChatBadge();

            // Update header
            document.getElementById('active-chat-header').innerHTML = `
                <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">
                    ${chat.customerName.split(' ').map(n => n[0]).join('')}
                </div>
                <div>
                    <p class="font-bold">${chat.customerName}</p>
                    <p class="text-xs text-gray-500">Order: ${chat.orderId}</p>
                </div>
            `;

            // Render messages
            const messagesDiv = document.getElementById('chat-messages');
            messagesDiv.innerHTML = chat.messages.map(msg => `
                <div class="mb-4 flex ${msg.sender === 'admin' ? 'justify-end' : 'justify-start'}">
                    <div class="chat-bubble ${msg.sender === 'admin' ? 'bg-blue-600 text-white' : 'bg-white border'} rounded-lg px-4 py-2">
                        <p class="text-sm">${msg.text}</p>
                        <p class="text-xs ${msg.sender === 'admin' ? 'text-blue-100' : 'text-gray-400'} mt-1">${msg.time}</p>
                    </div>
                </div>
            `).join('');
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function openChat(customerName) {
            const chat = state.chats.find(c => c.customerName === customerName);
            if (chat) {
                switchTab('chat');
                setTimeout(() => openChatById(chat.id), 100);
            }
        }

        document.getElementById('chat-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message || !state.activeChat) return;

            const chat = state.chats.find(c => c.id === state.activeChat);
            if (chat) {
                const now = new Date();
                chat.messages.push({
                    sender: 'admin',
                    text: message,
                    time: now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })
                });
                chat.lastMessage = message;
                chat.timestamp = 'Just now';
                
                openChatById(state.activeChat);
                input.value = '';
            }
        });

        function updateChatBadge() {
            const totalUnread = state.chats.reduce((sum, chat) => sum + chat.unread, 0);
            const badge = document.getElementById('chat-badge');
            if (totalUnread > 0) {
                badge.textContent = totalUnread;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // Helper Functions
        function updateStats() {
            const activeOrders = state.orders.filter(o => o.status !== 'delivered').length;
            const availableRiders = state.riders.filter(r => r.status === 'available').length;
            
            document.getElementById('active-orders-count').textContent = activeOrders;
            document.getElementById('available-riders-count').textContent = availableRiders;
        }

        function assignRider(orderId) {
            const availableRider = state.riders.find(r => r.status === 'available');
            if (!availableRider) {
                alert('No riders available at the moment');
                return;
            }
            
            const order = state.orders.find(o => o.id === orderId);
            order.riderId = availableRider.id;
            order.status = 'picked-up';
            availableRider.status = 'active';
            availableRider.orderId = orderId;
            
            renderOrders();
            renderRiders();
            updateStats();
            alert(`Order ${orderId} assigned to ${availableRider.name}`);
        }

        function trackOrder(orderId) {
            const order = state.orders.find(o => o.id === orderId);
            if (order && order.riderId) {
                switchTab('riders');
                setTimeout(() => focusRider(order.riderId), 200);
            } else {
                alert('This order has not been assigned to a rider yet');
            }
        }

        // Settings Management
        let uploadedImages = [];
        let currentLogo = null;

        // Logo Management
        document.addEventListener('DOMContentLoaded', function() {
            const logoUpload = document.getElementById('logo-upload');
            if (logoUpload) {
                logoUpload.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            currentLogo = event.target.result;
                            document.getElementById('logo-preview').src = currentLogo;
                            document.getElementById('logo-preview').classList.remove('hidden');
                            document.getElementById('logo-placeholder').classList.add('hidden');
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            // Gallery Upload
            const galleryUpload = document.getElementById('gallery-upload');
            if (galleryUpload) {
                galleryUpload.addEventListener('change', function(e) {
                    const files = Array.from(e.target.files);
                    files.forEach(file => {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const imageData = {
                                id: Date.now() + Math.random(),
                                src: event.target.result,
                                name: file.name,
                                uploadDate: new Date().toLocaleDateString()
                            };
                            uploadedImages.push(imageData);
                            renderImageGallery();
                        };
                        reader.readAsDataURL(file);
                    });
                });
            }

            // Import Settings
            const importSettings = document.getElementById('import-settings');
            if (importSettings) {
                importSettings.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            try {
                                const settings = JSON.parse(event.target.result);
                                applyImportedSettings(settings);
                                alert('Settings imported successfully!');
                            } catch (error) {
                                alert('Error importing settings: Invalid file format');
                            }
                        };
                        reader.readAsText(file);
                    }
                });
            }
        });

        function updateLogo() {
            if (!currentLogo) {
                alert('Please select a logo image first');
                return;
            }
            
            // Update logo in header
            const headerIcon = document.querySelector('header svg');
            if (headerIcon) {
                const img = document.createElement('img');
                img.src = currentLogo;
                img.className = 'w-8 h-8 rounded';
                headerIcon.replaceWith(img);
            }
            
            // Save to localStorage
            localStorage.setItem('aloto-logo', currentLogo);
            alert('Logo updated successfully!');
        }

        function resetLogo() {
            currentLogo = null;
            document.getElementById('logo-preview').classList.add('hidden');
            document.getElementById('logo-placeholder').classList.remove('hidden');
            localStorage.removeItem('aloto-logo');
            alert('Logo reset to default');
            location.reload();
        }

        function renderImageGallery() {
            const gallery = document.getElementById('image-gallery');
            if (!gallery) return;
            
            gallery.innerHTML = uploadedImages.map(img => `
                <div class="relative group">
                    <img src="${img.src}" alt="${img.name}" class="w-full h-40 object-cover rounded-lg border-2 border-gray-200">
                    <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition rounded-lg flex items-center justify-center">
                        <button onclick="deleteImage('${img.id}')" class="opacity-0 group-hover:opacity-100 bg-red-600 text-white p-2 rounded-full hover:bg-red-700 transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                        </button>
                    </div>
                    <div class="mt-2">
                        <p class="text-xs text-gray-600 truncate">${img.name}</p>
                        <p class="text-xs text-gray-400">${img.uploadDate}</p>
                    </div>
                </div>
            `).join('');
        }

        function deleteImage(imageId) {
            if (confirm('Are you sure you want to delete this image?')) {
                uploadedImages = uploadedImages.filter(img => img.id != imageId);
                renderImageGallery();
                saveImagesToStorage();
            }
        }

        function saveSettings() {
            const settings = {
                companyName: document.getElementById('company-name').value,
                primaryColor: document.getElementById('primary-color').value,
                contactEmail: document.getElementById('contact-email').value,
                contactPhone: document.getElementById('contact-phone').value,
                logo: currentLogo
            };

            // Save to localStorage
            localStorage.setItem('aloto-settings', JSON.stringify(settings));
            
            // Apply settings immediately
            applySettings(settings);
            
            alert('Settings saved successfully!');
        }

        function applySettings(settings) {
            // Update company name
            if (settings.companyName) {
                document.querySelector('header h1').textContent = settings.companyName;
            }
            
            // Update primary color
            if (settings.primaryColor) {
                const style = document.createElement('style');
                style.textContent = `
                    .bg-blue-600 { background-color: ${settings.primaryColor} !important; }
                    .text-blue-600 { color: ${settings.primaryColor} !important; }
                    .border-blue-600 { border-color: ${settings.primaryColor} !important; }
                `;
                document.head.appendChild(style);
            }
        }

        function exportSettings() {
            const settings = {
                companyName: document.getElementById('company-name').value,
                primaryColor: document.getElementById('primary-color').value,
                contactEmail: document.getElementById('contact-email').value,
                contactPhone: document.getElementById('contact-phone').value,
                logo: currentLogo,
                images: uploadedImages
            };

            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'aloto-rides-settings.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function applyImportedSettings(settings) {
            if (settings.companyName) document.getElementById('company-name').value = settings.companyName;
            if (settings.primaryColor) document.getElementById('primary-color').value = settings.primaryColor;
            if (settings.contactEmail) document.getElementById('contact-email').value = settings.contactEmail;
            if (settings.contactPhone) document.getElementById('contact-phone').value = settings.contactPhone;
            if (settings.logo) {
                currentLogo = settings.logo;
                document.getElementById('logo-preview').src = currentLogo;
                document.getElementById('logo-preview').classList.remove('hidden');
                document.getElementById('logo-placeholder').classList.add('hidden');
            }
            if (settings.images) {
                uploadedImages = settings.images;
                renderImageGallery();
            }
            
            applySettings(settings);
        }

        function saveImagesToStorage() {
            localStorage.setItem('aloto-images', JSON.stringify(uploadedImages));
        }

        function loadSavedSettings() {
            // Load saved settings
            const savedSettings = localStorage.getItem('aloto-settings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    applyImportedSettings(settings);
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }

            // Load saved images
            const savedImages = localStorage.getItem('aloto-images');
            if (savedImages) {
                try {
                    uploadedImages = JSON.parse(savedImages);
                    renderImageGallery();
                } catch (e) {
                    console.error('Error loading images:', e);
                }
            }

            // Load saved logo
            const savedLogo = localStorage.getItem('aloto-logo');
            if (savedLogo) {
                currentLogo = savedLogo;
                const headerIcon = document.querySelector('header svg');
                if (headerIcon) {
                    const img = document.createElement('img');
                    img.src = savedLogo;
                    img.className = 'w-8 h-8 rounded';
                    headerIcon.replaceWith(img);
                }
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeSampleData();
            updateChatBadge();
            loadSavedSettings();
            
            // Register Service Worker for PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => console.log('ServiceWorker registered'))
                    .catch(err => console.log('ServiceWorker registration failed'));
            }
            
            // Install prompt for PWA
            let deferredPrompt;
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Show custom install button/banner
                const installBanner = document.createElement('div');
                installBanner.className = 'fixed bottom-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg max-w-sm z-50';
                installBanner.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex-1 mr-4">
                            <p class="font-bold mb-1">Install Aloto Rides</p>
                            <p class="text-sm text-blue-100">Install this app on your device for quick access</p>
                        </div>
                        <button id="install-btn" class="bg-white text-blue-600 px-4 py-2 rounded font-medium hover:bg-blue-50 whitespace-nowrap">
                            Install
                        </button>
                        <button id="dismiss-btn" class="ml-2 text-white hover:text-blue-100">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                        </button>
                    </div>
                `;
                document.body.appendChild(installBanner);
                
                document.getElementById('install-btn').addEventListener('click', async () => {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`User response: ${outcome}`);
                    deferredPrompt = null;
                    installBanner.remove();
                });
                
                document.getElementById('dismiss-btn').addEventListener('click', () => {
                    installBanner.remove();
                });
            });
        });
    </script>
</body>
</html>
